{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.15", "generated_at": "2025-12-30T10:57:11.068606Z", "invocation_id": "8915803a-6faf-4694-abb2-afcf7cbeeff2", "invocation_started_at": "2025-12-30T10:57:05.799723Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-30T10:57:08.248659Z", "completed_at": "2025-12-30T10:57:08.267938Z"}, {"name": "execute", "started_at": "2025-12-30T10:57:08.270309Z", "completed_at": "2025-12-30T10:57:10.962622Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.7166504859924316, "adapter_response": {"_message": "SELECT 1008", "code": "SELECT", "rows_affected": 1008}, "message": "SELECT 1008", "failures": null, "unique_id": "model.across_analytics.mart_general_overview", "compiled": true, "compiled_code": "-- mart_general_overview.sql\n-- PURPOSE: High-level protocol overview for the main Superset dashboard\n-- GRAIN: Hour \u00d7 Origin Chain \u00d7 Destination Chain \u00d7 Token\n-- WHY: Provides general metrics with drill-down capability for flexible Superset filtering\n\n\n\nWITH base_data AS (\n    SELECT\n        *,\n        DATE_TRUNC('hour', deposit_timestamp) AS deposit_hour\n    FROM \"across_analytics\".\"dbt_intermediate\".\"int_deposit_fill_matching\"\n),\n\n-- Chain name mapping\nchain_names AS (\n    SELECT \n        chain_id,\n        chain_name\n    FROM (VALUES\n        (1, 'Ethereum'),\n        (42161, 'Arbitrum'),\n        (137, 'Polygon'),\n        (59144, 'Linea'),\n        (480, 'Worldchain'),\n        (130, 'Unichain'),\n        (999, 'HyperEVM'),\n        (143, 'Monad')\n    ) AS chains(chain_id, chain_name)\n),\n\n-- Token metadata for symbol lookup\ntoken_metadata AS (\n    SELECT * FROM \"across_analytics\".\"dbt\".\"token_metadata\"\n),\n\n-- Aggregate by hour, route, and token\nhourly_metrics AS (\n    SELECT\n        deposit_hour,\n        origin_chain_id,\n        destination_chain_id,\n        route_id,\n        deposit_token,\n        \n        -- === VOLUME METRICS ===\n        -- Transaction counts\n        COUNT(*) AS total_deposits,\n        SUM(CASE WHEN is_filled THEN 1 ELSE 0 END) AS total_fills,\n        \n        -- Volume in native token units\n        SUM(deposit_amount) AS total_deposit_volume,\n        SUM(CASE WHEN is_filled THEN actual_output_amount ELSE 0 END) AS total_filled_volume,\n        \n        -- Volume in USD\n        SUM(deposit_amount_usd) AS total_deposit_volume_usd,\n        SUM(CASE WHEN is_filled THEN fill_amount_usd ELSE 0 END) AS total_filled_volume_usd,\n        \n        -- === ACTIVITY METRICS ===\n        COUNT(DISTINCT depositor_address) AS unique_depositors,\n        COUNT(DISTINCT relayer_address) FILTER (WHERE is_filled) AS unique_relayers,\n        \n        -- === PERFORMANCE SNAPSHOT (summary only) ===\n        -- Fill rate\n        ROUND((SUM(CASE WHEN is_filled THEN 1 ELSE 0 END)::NUMERIC / NULLIF(COUNT(*), 0)) * 100, 2) AS fill_rate_pct,\n        \n        -- Latency summary (just avg and median for overview)\n        ROUND(AVG(CASE WHEN is_filled THEN fill_latency_seconds END)::NUMERIC, 2) AS avg_fill_latency_seconds,\n        ROUND(PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY fill_latency_seconds) FILTER (WHERE is_filled)::NUMERIC, 2) AS median_fill_latency_seconds,\n        \n        -- === ECONOMIC SNAPSHOT (summary only) ===\n        -- Total fees collected\n        SUM(CASE WHEN is_filled THEN bridge_fee_nominal ELSE 0 END) AS total_bridge_fees,\n        \n        -- Average fee percentage\n        ROUND(AVG(CASE WHEN is_filled THEN bridge_fee_percent END)::NUMERIC, 4) AS avg_bridge_fee_pct,\n        \n        -- Average slippage\n        ROUND(AVG(CASE WHEN is_filled THEN slippage_percent END)::NUMERIC, 4) AS avg_slippage_pct\n        \n    FROM base_data\n    GROUP BY \n        deposit_hour,\n        origin_chain_id,\n        destination_chain_id,\n        route_id,\n        deposit_token\n)\n\nSELECT\n    -- Time dimension\n    hm.deposit_hour,\n    \n    -- Route identifiers with human-readable names\n    hm.origin_chain_id,\n    oc.chain_name AS origin_chain_name,\n    hm.destination_chain_id,\n    dc.chain_name AS destination_chain_name,\n    hm.route_id,\n    oc.chain_name || ' \u2192 ' || dc.chain_name AS route_name,\n    \n    -- Token info\n    hm.deposit_token,\n    tm.token_symbol,\n    -- handle token symbol for base token as USDC.e and USDC.bridged are the same, etc.\n    CASE \n        WHEN token_symbol LIKE 'USDC%' THEN 'USDC'\n        WHEN token_symbol LIKE 'USDT%' THEN 'USDT'\n        WHEN token_symbol LIKE 'DAI%' THEN 'DAI'\n        WHEN token_symbol LIKE 'WETH%' THEN 'WETH'\n        WHEN token_symbol LIKE 'WBTC%' THEN 'WBTC'\n    ELSE token_symbol\n    END AS base_token_symbol,\n    \n    -- Volume metrics\n    hm.total_deposits,\n    hm.total_fills,\n    hm.total_deposit_volume,\n    hm.total_filled_volume,\n    hm.total_deposit_volume_usd,\n    hm.total_filled_volume_usd,\n    \n    -- Activity metrics\n    hm.unique_depositors,\n    hm.unique_relayers,\n    \n    -- Performance snapshot\n    hm.fill_rate_pct,\n    hm.avg_fill_latency_seconds,\n    hm.median_fill_latency_seconds,\n    \n    -- Economic snapshot\n    hm.total_bridge_fees,\n    hm.avg_bridge_fee_pct,\n    hm.avg_slippage_pct\n\nFROM hourly_metrics hm\nLEFT JOIN chain_names oc ON hm.origin_chain_id = oc.chain_id\nLEFT JOIN chain_names dc ON hm.destination_chain_id = dc.chain_id\nLEFT JOIN token_metadata tm ON hm.origin_chain_id = tm.chain_id \n    AND LOWER(hm.deposit_token) = LOWER(tm.token_address)\n\nORDER BY hm.deposit_hour DESC, hm.total_deposit_volume_usd DESC", "relation_name": "\"across_analytics\".\"dbt_marts\".\"mart_general_overview\"", "batch_results": null}], "elapsed_time": 3.5235791206359863, "args": {"project_dir": "C:\\Users\\Longin\\Desktop\\Projects\\across_analytics", "defer": false, "use_fast_test_edges": false, "state_modified_compare_more_unrendered_values": false, "invocation_command": "dbt run --select mart_general_overview", "indirect_selection": "eager", "partial_parse_file_diff": true, "require_batched_execution_for_custom_microbatch_strategy": false, "version_check": true, "log_format": "default", "log_level_file": "debug", "require_resource_names_without_spaces": true, "exclude": [], "quiet": false, "send_anonymous_usage_stats": true, "populate_cache": true, "log_file_max_bytes": 10485760, "source_freshness_run_project_hooks": true, "select": ["mart_general_overview"], "state_modified_compare_vars": false, "cache_selected_only": false, "show_all_deprecations": false, "introspect": true, "print": true, "validate_macro_args": false, "partial_parse": true, "use_colors_file": true, "log_level": "info", "strict_mode": false, "static_parser": true, "skip_nodes_if_on_run_start_fails": false, "upload_to_artifacts_ingest_api": false, "vars": {}, "favor_state": false, "log_path": "C:\\Users\\Longin\\Desktop\\Projects\\across_analytics\\logs", "require_yaml_configuration_for_mf_time_spines": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "printer_width": 80, "which": "run", "show_resource_report": false, "require_generic_test_arguments_property": true, "profiles_dir": "C:\\Users\\Longin\\.dbt", "log_format_file": "debug", "macro_debugging": false, "write_json": true, "empty": false, "require_nested_cumulative_type_params": false, "use_colors": true, "require_explicit_package_overrides_for_builtin_materializations": true, "require_all_warnings_handled_by_warn_error": false}}